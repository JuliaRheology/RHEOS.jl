<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Frequency data · RHEOS.jl</title><meta name="title" content="Frequency data · RHEOS.jl"/><meta property="og:title" content="Frequency data · RHEOS.jl"/><meta property="twitter:title" content="Frequency data · RHEOS.jl"/><meta name="description" content="Documentation for RHEOS.jl."/><meta property="og:description" content="Documentation for RHEOS.jl."/><meta property="twitter:description" content="Documentation for RHEOS.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="RHEOS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RHEOS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><a class="tocitem" href="../fileio/">File I/O</a></li><li><a class="tocitem" href="../preprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../gendata/">Generating Data</a></li><li><span class="tocitem">Fit and Predict</span><ul><li><a class="tocitem" href="../fitpredictTime/">Time data</a></li><li class="is-active"><a class="tocitem" href>Frequency data</a><ul class="internal"><li><a class="tocitem" href="#Fitting"><span>Fitting</span></a></li><li><a class="tocitem" href="#Predicting"><span>Predicting</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../numerical/">Numerical Aspects</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../model_elements/">Basic Elements</a></li><li><a class="tocitem" href="../model_maxwell/">Maxwell</a></li><li><a class="tocitem" href="../model_kv/">Kelvin-Voigt</a></li><li><a class="tocitem" href="../model_zener/">Zener</a></li><li><a class="tocitem" href="../model_pt/">Poynting-Thomson</a></li><li><a class="tocitem" href="../model_burgers/">Burgers</a></li><li><a class="tocitem" href="../model_create/">Create Your Model</a></li></ul></li><li><a class="tocitem" href="../examples/">Additional Examples</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Fit and Predict</a></li><li class="is-active"><a href>Frequency data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Frequency data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaRheology/RHEOS.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fitting-and-Predicting-Frequency-Data-{#freq-data}"><a class="docs-heading-anchor" href="#Fitting-and-Predicting-Frequency-Data-{#freq-data}">Fitting and Predicting - Frequency Data {#freq-data}</a><a id="Fitting-and-Predicting-Frequency-Data-{#freq-data}-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-and-Predicting-Frequency-Data-{#freq-data}" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaRheology/RHEOS.jl/gh-pages?filepath=dev/notebooks/fitpredictFreq.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaRheology/RHEOS.jl/blob/gh-pages/dev/notebooks/fitpredictFreq.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>RHEOS can also fit models to dynamic mechanical analysis data from oscillatory tests.</p><pre><code class="language-julia hljs">using RHEOS</code></pre><h2 id="Fitting"><a class="docs-heading-anchor" href="#Fitting">Fitting</a><a id="Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting" title="Permalink"></a></h2><h4 id="Step-1:-Loading-Experimental-Data"><a class="docs-heading-anchor" href="#Step-1:-Loading-Experimental-Data">Step 1: Loading Experimental Data</a><a id="Step-1:-Loading-Experimental-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Loading-Experimental-Data" title="Permalink"></a></h4><p>RHEOS has a convenient function to import data from CSV files (more information in <a href="../fileio/#File-I/O">File I/O</a> section).</p><pre><code class="language-julia hljs">data = importcsv(&quot;assets/data_freq.csv&quot;, ω_col = 1, Gp_col = 2, Gpp_col = 3)
rheofreqdatatype(data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">with_modulus::FreqDataType = 1</code></pre><p>The frequency, storage modulus and loss modulus are stored into a <a href="../API/#RHEOS.RheoFreqData"><code>RheoFreqData</code></a> struct.</p><h4 id="Step-2:-Model-Fit"><a class="docs-heading-anchor" href="#Step-2:-Model-Fit">Step 2: Model Fit</a><a id="Step-2:-Model-Fit-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Model-Fit" title="Permalink"></a></h4><p>Let&#39;s fit a Fractional Kelvin-Voigt model. The first argument is our data, the second argument tells RHEOS which model to fit (<a href="../API/#RHEOS.RheoModelClass"><code>RheoModelClass</code></a>). The function will return a <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> object, i.e. a <a href="../API/#RHEOS.RheoModelClass"><code>RheoModelClass</code></a> with fixed values for the parameters. The function <a href="../API/#RHEOS.dynamicmodelfit"><code>dynamicmodelfit</code></a> possesses all the additional arguments (lower and upper bounds, initial parameters, tolerance) as for the fitting of time data. Note that initial parameters, upper bounds and lower bounds can be partially specified and the rest will be filled in automatically.</p><pre><code class="language-julia hljs"># Lower bounds
Lo = (cₐ = 0.0, a = 0.01, cᵦ = 0.0, β = 0.01)
# Upper bounds
Hi = (cₐ = 1e2, a = 0.99, cᵦ = 1e2, β = 0.99)
# Initial parameters
P0 = (cₐ = 1.0, a = 0.36, cᵦ = 1.0, β = 0.03)

FractKV_model = dynamicmodelfit(data, Fract_KelvinVoigt, weights = &quot;log&quot;, lo = Lo, hi = Hi, p0 = P0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Model name: fractKV

Free parameters: 


Fixed parameters: (cₐ = 0.009444444354349515, a = 0.7669468645264774, cᵦ = 0.914778549164041, β = 0.09972297772570522)

                ________ ╱╲ ________
               |         ╲╱  cₐ, a  |
           ____|                    |____
               |                    |
               |________ ╱╲ ________|
                         ╲╱  cᵦ, β
                </code></pre><p>For the fitting process RHEOS relies on the optimistion package <a href="https://nlopt.readthedocs.io/en/latest/">NLopt.jl</a>. RHEOS makes use of a local derivative free algorithm, specifically the Tom Rowan&#39;s &quot;Subplex&quot; algorithm originally introduced in his <a href="https://dl.acm.org/doi/book/10.5555/100816">PhD thesis at The University of Texas at Austin, 1990</a>.</p><p>The storage and loss moduli can sometimes occupy different orders of magnitude. This can cause problems during fitting as the optimisation routine will weight errors at the higher orders of magnitude more strongly than those at the lower orders of magnitude. This is a more general problem often faced during multi-objective optimisation problems. RHEOS offers four rescaling options (weight):</p><ul><li>The <code>local</code> option rescales the cost at each point by the point itself.</li><li>The <code>log</code> approach simply re-scales all the storage and loss moduli and their predicted values logarithmically before finding the error between them.</li><li>A third option in RHEOS divides the cost at each point by the mean value of the storage and loss modulus respectively depending on which cost is being calculated. This can work well but performance is hindered if the storage or loss moduli individually vary over many orders of magnitude (<code>mean</code>).</li><li>The fourth option offered by RHEOS is simply manual weightings provided by the user for each modulus (<code>manual</code>).</li></ul><p>In the first two cases, the benefit arises from the fact that the optimisation weighting is rebalanced in favour of smaller values. The logarithmic rescaling method seems to work particularly well but runs into problems if the storage or loss moduli are exactly 0 at any frequency, this is due to the negative singularity of the logarithmic function for the 0 argument. 0 arguments can also cause problems using the <code>local</code> option due to division by 0.</p><h2 id="Predicting"><a class="docs-heading-anchor" href="#Predicting">Predicting</a><a id="Predicting-1"></a><a class="docs-heading-anchor-permalink" href="#Predicting" title="Permalink"></a></h2><p>RHEOS allows the user to simulate the frequency response of a model (with defined parameters, <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> struct) to an imposed loading.</p><p>Given an incomplete data set (frequency only) and model with values substituted into parameters (<a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a>), return a new &quot;complete&quot; dataset based on the model with the simulated missing variable (storage and loss).</p><h4 id="Assessing-the-Quality-of-Fit"><a class="docs-heading-anchor" href="#Assessing-the-Quality-of-Fit">Assessing the Quality of Fit</a><a id="Assessing-the-Quality-of-Fit-1"></a><a class="docs-heading-anchor-permalink" href="#Assessing-the-Quality-of-Fit" title="Permalink"></a></h4><p>The ability of predicting model&#39;s response is first exploited to assess the quality of the fits above. The incomplete <a href="../API/#RHEOS.RheoFreqData"><code>RheoFreqData</code></a> variable is defined by extracting the frequency from the original data or by defining a new frequency vector.</p><pre><code class="language-julia hljs">data_ext = onlyfreq(data)
# Alternatively, a RheoFreqData with only frequency data can be generated as
# data_ext = frequencyspec(ω_start = 1.0e-2, ω_end = 1.0e2, logstep = 0.1)

rheofreqdatatype(data_ext)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">freq_only::FreqDataType = 0</code></pre><p>For the prediction, RHEOS&#39; function <a href="../API/#RHEOS.dynamicmodelpredict"><code>dynamicmodelpredict</code></a> requires the incomplete data set and a model with fixed parameters (<a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a>). For the assessment of the fitting quality the <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> is the output of the fitting function.</p><pre><code class="language-julia hljs">fractKV_predict = dynamicmodelpredict(data_ext, FractKV_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"></code></pre><p>Now we can plot data and model together for comparison</p><pre><code class="language-julia hljs">using Plots
# Create the plot
p = plot(
    xaxis = :log10,
    yaxis = :log10,
    xlabel = &quot;Frequency&quot;,
    ylabel = &quot;Storage and Loss moduli&quot;,
    legend = :bottomright, linewidth=4, framestyle = :box
)
# Plot data points
scatter!(p, data.ω, data.Gp, markersize = 6, color = :blue, label = &quot;Gp data&quot;)
scatter!(p, data.ω, data.Gpp, markersize = 6, color = :red, label = &quot;Gpp data&quot;)
# Plot model predictions
plot!(p, fractKV_predict.ω, fractKV_predict.Gp, linestyle = :dash, color = :blue, linewidth = 3, label = &quot;Gp model&quot;)
plot!(p, fractKV_predict.ω, fractKV_predict.Gpp, linestyle = :dash, color = :red, linewidth = 3, label = &quot;Gpp model&quot;)</code></pre><img src="13065467.svg" alt="Example block output"/><h4 id="Simulate-Different-Model-Behaviours"><a class="docs-heading-anchor" href="#Simulate-Different-Model-Behaviours">Simulate Different Model Behaviours</a><a id="Simulate-Different-Model-Behaviours-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-Different-Model-Behaviours" title="Permalink"></a></h4><p>The ability of predicting model&#39;s response can be exploited to simulate the behaviour of the model to other external loading conditions. For example, we will explore the response of the fitted model to a creep experiment.</p><p>First we need to define an incomplete <a href="../API/#RHEOS.RheoTimeData"><code>RheoTimeData</code></a> struct, which can be achieved via the data generation functions provided in RHEOS (see section <a href="../gendata/#Generating-Data">Generating Data</a>).</p><pre><code class="language-julia hljs"># Define timeline
dσ = timeline(t_end = 10)
# and a step in stress
dσ = stressfunction(dσ, hstep())

# we can now predict the creep response of the Maxwell model
FractKV_creepPredict = modelsteppredict(dσ, FractKV_model)
# Visualisation of the simulated response
using Plots
p = plot(size = (700, 500) )
plot!(p, FractKV_creepPredict.t,
    FractKV_creepPredict.ϵ,
    xlabel = &quot;Time&quot;,
    ylabel = &quot;Strain&quot;,
    legend = false, linewidth=4, framestyle = :box
)</code></pre><img src="cd9f3c3a.svg" alt="Example block output"/><p><strong>Reference frequency data</strong>: Deng, Linhong, et al. &quot;Fast and slow dynamics of the cytoskeleton.&quot; Nature materials 5.8 (2006): 636.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fitpredictTime/">« Time data</a><a class="docs-footer-nextpage" href="../numerical/">Numerical Aspects »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 17 February 2026 13:57">Tuesday 17 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
