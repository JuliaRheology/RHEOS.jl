<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fitting and Predicting - Time Data · RHEOS.jl</title><meta name="title" content="Fitting and Predicting - Time Data · RHEOS.jl"/><meta property="og:title" content="Fitting and Predicting - Time Data · RHEOS.jl"/><meta property="twitter:title" content="Fitting and Predicting - Time Data · RHEOS.jl"/><meta name="description" content="Documentation for RHEOS.jl."/><meta property="og:description" content="Documentation for RHEOS.jl."/><meta property="twitter:description" content="Documentation for RHEOS.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="RHEOS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RHEOS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><a class="tocitem" href="../fileio/">File I/O</a></li><li><a class="tocitem" href="../preprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../gendata/">Generating Data</a></li><li><span class="tocitem">Fit and Predict</span><ul><li><a class="tocitem" href="../fitpredictTime/">Time data</a></li><li><a class="tocitem" href="../fitpredictFreq/">Frequency data</a></li></ul></li><li><a class="tocitem" href="../numerical/">Numerical Aspects</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../model_elements/">Basic Elements</a></li><li><a class="tocitem" href="../model_maxwell/">Maxwell</a></li><li><a class="tocitem" href="../model_kv/">Kelvin-Voigt</a></li><li><a class="tocitem" href="../model_zener/">Zener</a></li><li><a class="tocitem" href="../model_pt/">Poynting-Thomson</a></li><li><a class="tocitem" href="../model_burgers/">Burgers</a></li><li><a class="tocitem" href="../model_create/">Create Your Model</a></li></ul></li><li><a class="tocitem" href="../examples/">Additional Examples</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Fitting and Predicting - Time Data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fitting and Predicting - Time Data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaRheology/RHEOS.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fitting-and-Predicting-Time-Data"><a class="docs-heading-anchor" href="#Fitting-and-Predicting-Time-Data">Fitting and Predicting - Time Data</a><a id="Fitting-and-Predicting-Time-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-and-Predicting-Time-Data" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaRheology/RHEOS.jl/gh-pages?filepath=dev/notebooks/fitpredictTime.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaRheology/RHEOS.jl/blob/gh-pages/dev/notebooks/fitpredictTime.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>A large majority of scientists and engineers who undertake rheological experiments fit their data with one or several viscoelastic models in order to classify materials, quantify their behaviour and predict their response to external perturbations.</p><p>Standard linear viscoelastic models take the form of an ordinary differential equation between stress σ and strain ϵ. Fitting models and predicting their response in the time domain then requires computing viscoelastic hereditary integrals such as:</p><p class="math-container">\[\sigma(t) = \int_{0}^t G(t - \tau) \frac{d \epsilon(\tau)}{d \tau} d \tau\]</p><p>where G is the relaxation response (stress response to a step in strain) of the material, which can be analytically or numerically defined for each rheological model and its set of rheological parameters. A similar relation exists to calculate the strain from the stress history:</p><p class="math-container">\[\epsilon(t) = \int_{0}^t J(t - \tau) \frac{d \sigma(\tau)}{d \tau} d \tau\]</p><p>where J is the creep modulus of the material. Fitting and predicting behaviour then becomes non-trivial and standardised tools to process are needed.</p><pre><code class="language-julia hljs">using RHEOS</code></pre><h2 id="Fitting"><a class="docs-heading-anchor" href="#Fitting">Fitting</a><a id="Fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting" title="Permalink"></a></h2><h4 id="Step-1:-Loading-in-Experimental-Data"><a class="docs-heading-anchor" href="#Step-1:-Loading-in-Experimental-Data">Step 1: Loading in Experimental Data</a><a id="Step-1:-Loading-in-Experimental-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Loading-in-Experimental-Data" title="Permalink"></a></h4><p>RHEOS has a convenient function to import data from CSV files (more information in <a href="../fileio/#File-I/O">File I/O</a> section).</p><pre><code class="language-julia hljs">data = importcsv(&quot;assets/data_time.csv&quot;, t_col = 1, ϵ_col = 2, σ_col = 3)
rheotimedatatype(data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">strain_and_stress::TimeDataType = 3</code></pre><p>The time, strain and stress data are stored into a <a href="../API/#RHEOS.RheoTimeData"><code>RheoTimeData</code></a> struct.</p><h4 id="Step-2:-Fitting-Models"><a class="docs-heading-anchor" href="#Step-2:-Fitting-Models">Step 2: Fitting Models</a><a id="Step-2:-Fitting-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Fitting-Models" title="Permalink"></a></h4><p>Let&#39;s fit a Maxwell model via its relaxation modulus, G, as our data is from a stress relaxation test, thus the strain is imposed. The first argument is our data, the second argument tells RHEOS which model to fit (<a href="../API/#RHEOS.RheoModelClass"><code>RheoModelClass</code></a>) and the final argument tells RHEOS whether to fit the model using a relaxation modulus (<em>strain</em> imposed) or creep modulus (<em>stress</em> imposed). The function will return a <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> object, i.e. a <a href="../API/#RHEOS.RheoModelClass"><code>RheoModelClass</code></a> with fixed values for the parameters.</p><p>maxwell<em>model = modelfit(data, Maxwell, strain</em>imposed, optmethod=:LN_SBPLX)</p><pre><code class="language-julia hljs">maxwell_model = modelfit(data, Maxwell, strain_imposed, optmethod=:LN_BOBYQA)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Model name: maxwell

Free parameters: 


Fixed parameters: (η = 1.1244553070683092, k = 0.5684104819565925)

                ___
            _____| |________╱╲  ╱╲  ╱╲  ___
                _|_|          ╲╱  ╲╱  ╲╱
                  η                  k
               </code></pre><p>For the fitting process RHEOS relies on the optimistion package <a href="https://nlopt.readthedocs.io/en/latest/">NLopt.jl</a>. RHEOS makes use of a local derivative free algorithm, specifically the Tom Rowan&#39;s &quot;Subplex&quot; algorithm originally introduced in his <a href="https://dl.acm.org/doi/book/10.5555/100816">PhD thesis at The University of Texas at Austin, 1990</a>.</p><p>Next, we will fit a fractional Maxwell (spring) model (the only difference from the above model is that the dash-pot is replaced by a spring-pot). This time we will also add upper and lower bounds on the model parameters. This is highly recommended for fractional models in particular as values less than 0 or greater than 1 for the spring-pot parameter are unphysical and can cause errors in the Mittag-Leffler function used (more information about the fractional models in review TBA). To facilitate the convergence of the fitting algorithm, it is also suggested to define an initial set of parameters (the function uses 0.5 for all parameters not defined). For initial parameters, lower bounds and upper bounds, it is possible to only specify some of the parameters and the rest will be filled in automatically.</p><p>:GN<em>ISRES :LN</em>COBYLA  :LN_BOBYQA</p><pre><code class="language-julia hljs"># Lower bounds
Lo = (cₐ = 0.0, a = 0.01, k = 0.0)
# Upper bounds</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(cₐ = 0.0, a = 0.01, k = 0.0)</code></pre><p>Hi = (cₐ = Inf, a = 0.99, k = Inf)</p><pre><code class="language-julia hljs">Hi = (cₐ = 10, a = 0.99, k = 10)
# Initial parameters
P0 = (cₐ = 0.1, a = 0.2, k = 2.0)

Fmaxwell_model = modelfit(data, FractS_Maxwell, strain_imposed, lo = Lo, hi = Hi, p0 = P0 , optmethod=:LN_SBPLX)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Model name: fractmaxwell_spring

Free parameters: 


Fixed parameters: (cₐ = 3.9383500588392377, a = 0.99, k = 2.029041423678936)

           ___╱╲_________╱╲  ╱╲  ╱╲  ________
              ╲╱           ╲╱  ╲╱  ╲╱
                cₐ,a               k
               </code></pre><p>Further optional parameters can be defined in the fitting function, such as the relative tolerance (default parameter of 1e-4) or the finite difference formula to use for the derivative (<code>&quot;BD&quot;</code> = Backward Difference (default), <code>&quot;CD&quot;</code> = Central Difference). If the user is interested in the model parameters on each optimisation iteration, they can be printed on the terminal by enabling <code>verbose = true</code>.</p><div class="admonition is-warning" id="Important-2c1ea8ae6ec461c4"><header class="admonition-header">Important<a class="admonition-anchor" href="#Important-2c1ea8ae6ec461c4" title="Permalink"></a></header><div class="admonition-body"><p>Often an ideal step loading is assumed, which simplifies the equations in the first section to σ(t) = G(t)ϵ₀ and ϵ(t) = J(t)σ₀. This enables the modulus to be used directly for the fitting, which vastly reduces the computational burden. For this reason, RHEOS provides a dedicated function <a href="../API/#RHEOS.modelstepfit"><code>modelstepfit</code></a> that requires the same parameters as <a href="../API/#RHEOS.modelfit"><code>modelfit</code></a>. If this assumption is appropriate for the data then fitting can be sped up greatly by use of this function.</p></div></div><h2 id="Predicting"><a class="docs-heading-anchor" href="#Predicting">Predicting</a><a id="Predicting-1"></a><a class="docs-heading-anchor-permalink" href="#Predicting" title="Permalink"></a></h2><p>RHEOS allows the user to simulate the response of a model (with defined parameters, <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> struct) to an imposed loading.</p><p>Given an incomplete data set (time data with only either stress or strain missing) and model with values substituted into parameters (<a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a>), return a new &quot;complete&quot; dataset based on the model with the simulated missing variable.</p><h4 id="Assess-Quality-of-the-Fit"><a class="docs-heading-anchor" href="#Assess-Quality-of-the-Fit">Assess Quality of the Fit</a><a id="Assess-Quality-of-the-Fit-1"></a><a class="docs-heading-anchor-permalink" href="#Assess-Quality-of-the-Fit" title="Permalink"></a></h4><p>The ability of predicting model&#39;s response is first exploited to assess the quality of the fits above. The incomplete <a href="../API/#RHEOS.RheoTimeData"><code>RheoTimeData</code></a> variable is defined by extracting the time and the imposed variable (for the current example, the strain).</p><pre><code class="language-julia hljs">data_ext = onlystrain(data)
# alternatively: data_ext = extract(data, 1);

rheotimedatatype(data_ext)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">strain_only::TimeDataType = 1</code></pre><p>For the prediction, RHEOS&#39; function <a href="../API/#RHEOS.modelpredict"><code>modelpredict</code></a> requires the incomplete data set and a model with fixed parameters (<a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a>). For the assessment of the fitting quality the <a href="../API/#RHEOS.RheoModel"><code>RheoModel</code></a> required is the output of the fitting function.</p><pre><code class="language-julia hljs">maxwell_predict = modelpredict(data_ext, maxwell_model)

# Now we can plot data and model together for comparison
using Plots


# Plot data
plt = plot(size=(700,500))</code></pre><img src="80368ea0.svg" alt="Example block output"/><p>Original data (green dots)</p><pre><code class="language-julia hljs">scatter!(plt, data.t, data.σ,
         label=&quot;Data&quot;,
         color=:green,
         marker=:circle)

plot!(plt, maxwell_predict.t, maxwell_predict.σ,
      label=&quot;Fit&quot;,
      color=:blue,
      lw=2)</code></pre><img src="eb44e2ef.svg" alt="Example block output"/><p>Axes labels</p><pre><code class="language-julia hljs">xlabel!(&quot;Time&quot;)
ylabel!(&quot;Stress (blue - fit, green - data)&quot;)</code></pre><img src="335d371b.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 17 February 2026 10:30">Tuesday 17 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
