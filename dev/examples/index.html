<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Additional Examples · RHEOS.jl</title><meta name="title" content="Additional Examples · RHEOS.jl"/><meta property="og:title" content="Additional Examples · RHEOS.jl"/><meta property="twitter:title" content="Additional Examples · RHEOS.jl"/><meta name="description" content="Documentation for RHEOS.jl."/><meta property="og:description" content="Documentation for RHEOS.jl."/><meta property="twitter:description" content="Documentation for RHEOS.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="RHEOS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RHEOS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../architecture/">Architecture</a></li><li><a class="tocitem" href="../fileio/">File I/O</a></li><li><a class="tocitem" href="../preprocessing/">Preprocessing</a></li><li><a class="tocitem" href="../gendata/">Generating Data</a></li><li><span class="tocitem">Fit and Predict</span><ul><li><a class="tocitem" href="../fitpredictTime/">Time data</a></li><li><a class="tocitem" href="../fitpredictFreq/">Frequency data</a></li></ul></li><li><a class="tocitem" href="../numerical/">Numerical Aspects</a></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../model_elements/">Basic Elements</a></li><li><a class="tocitem" href="../model_maxwell/">Maxwell</a></li><li><a class="tocitem" href="../model_kv/">Kelvin-Voigt</a></li><li><a class="tocitem" href="../model_zener/">Zener</a></li><li><a class="tocitem" href="../model_pt/">Poynting-Thomson</a></li><li><a class="tocitem" href="../model_burgers/">Burgers</a></li><li><a class="tocitem" href="../model_create/">Create Your Model</a></li></ul></li><li class="is-active"><a class="tocitem" href>Additional Examples</a><ul class="internal"><li><a class="tocitem" href="#Example-1"><span>Example 1</span></a></li><li><a class="tocitem" href="#Example-2"><span>Example 2</span></a></li><li><a class="tocitem" href="#Example-3"><span>Example 3</span></a></li><li><a class="tocitem" href="#Example-4"><span>Example 4</span></a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Additional Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Additional Examples</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaRheology/RHEOS.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Additional-Examples"><a class="docs-heading-anchor" href="#Additional-Examples">Additional Examples</a><a id="Additional-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Examples" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaRheology/RHEOS.jl/gh-pages?filepath=dev/notebooks/examples.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaRheology/RHEOS.jl/blob/gh-pages/dev/notebooks/examples.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p><a href="https://github.com/JuliaPy/PyPlot.jl">PyPlot</a> needs to be installed to run these examples and display plots of the data.</p><pre><code class="language-julia hljs">using Plots

using RHEOS</code></pre><h2 id="Example-1"><a class="docs-heading-anchor" href="#Example-1">Example 1</a><a id="Example-1-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1" title="Permalink"></a></h2><ul><li>Loading experimental data from a .csv file</li><li>Fitting a model</li><li>Compare original data with fitted model prediction</li></ul><pre><code class="language-julia hljs"># Make sure the examples folder is the current directory
# check by typing &quot;pwd()&quot;

# Import data
data = importcsv(&quot;assets/example1_data.csv&quot;, t_col = 1, ϵ_col = 2, σ_col = 3)

# Plot data
p = plot(data.t, data.σ,
    seriestype = :scatter,
    color = :green,
    label = &quot;Stress&quot;,
    xlabel = &quot;Time&quot;,
    ylabel = &quot;Strain (blue), Stress (green)&quot;,
    legend = :topright,
    markersize = 4
)

plot!(p, data.t, data.ϵ, color = :blue, label = &quot;Strain&quot;, linewidth = 2)</code></pre><img src="43827f0c.svg" alt="Example block output"/><pre><code class="language-julia hljs"># We now fit a Maxwell model
maxwell_model = modelfit(data, Maxwell, strain_imposed)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Model name: maxwell

Free parameters: 


Fixed parameters: (η = 4.0054017305374146, k = 2.003000020980835)

                ___
            _____| |________╱╲  ╱╲  ╱╲  ___
                _|_|          ╲╱  ╲╱  ╲╱
                  η                  k
               </code></pre><p>Note that the fitting function requires guidance regarding the type of testing used. It helps optimise the fitting process.</p><p>The data in this example is the stress response to a strain ramp followed by plateau. It therefore corresponds to a strain imposed process.</p><p>We now want to calculate the stress values predicted by the model given the experimental strain data. Let&#39;s create a new data set with the strain profile.</p><pre><code class="language-julia hljs">maxwell_predict = onlystrain(data)
# and calculate the stress based on the model
maxwell_predict = modelpredict(maxwell_predict, maxwell_model)
# Now we can plot data and model together for comparison

# Plot data
p = plot(data.t, data.σ,
    seriestype = :scatter,
    color = :green,
    label = &quot;Data&quot;,
    xlabel = &quot;Time&quot;,
    ylabel = &quot;Stress&quot;,
    legend = :topright,
    markersize = 4
)

plot!(p, maxwell_predict.t, maxwell_predict.σ, color = :red, label = &quot;Maxwell fit&quot;, linewidth = 2)</code></pre><img src="f7db58e6.svg" alt="Example block output"/><h2 id="Example-2"><a class="docs-heading-anchor" href="#Example-2">Example 2</a><a id="Example-2-1"></a><a class="docs-heading-anchor-permalink" href="#Example-2" title="Permalink"></a></h2><p>This script is a slight modification of Example 1 to present to the user the possibility of creating new <a href="../API/#RHEOS.RheoModelClass"><code>RheoModelClass</code></a> from an existing one with some of the parameters frozen to specific values. As an example, we fix the spring constant of the model above (k) to 2 and we let RHEOS fit the viscosity η.</p><pre><code class="language-julia hljs">Maxwell_springFix = freeze_params(Maxwell, k = 2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Model name: maxwell

Free parameters: η


Fixed parameters: (k = 2.0,)

                ___
            _____| |________╱╲  ╱╲  ╱╲  ___
                _|_|          ╲╱  ╲╱  ╲╱
                  η                  k
               </code></pre><pre><code class="language-julia hljs">maxwellD_model = modelfit(data, Maxwell_springFix, strain_imposed)
maxwellD_predict = onlystrain(data)
# and calculate the stress based on the model
maxwellD_predict = modelpredict(maxwellD_predict, maxwellD_model)
# Now we can plot data and model together for comparison

# Plot data
p = plot(data.t, data.σ,
    seriestype = :scatter,
    color = :green,
    label = &quot;Data&quot;,
    xlabel = &quot;Time&quot;,
    ylabel = &quot;Stress&quot;,
    legend = :topright,
    markersize = 4
)

plot!(p, maxwellD_predict.t, maxwellD_predict.σ, color = :red, label = &quot;MaxwellD fit&quot;, linewidth = 2)</code></pre><img src="ae32dc6f.svg" alt="Example block output"/><h2 id="Example-3"><a class="docs-heading-anchor" href="#Example-3">Example 3</a><a id="Example-3-1"></a><a class="docs-heading-anchor-permalink" href="#Example-3" title="Permalink"></a></h2><p>This script shows how to use RHEOS to explore the behaviour of various models This involves:</p><ul><li>Creating a strain function</li><li>Defining models based on parameter values</li></ul><p>PyPlot needs to be installed to run these examples and display plots of the data.</p><pre><code class="language-julia hljs"># Creates a time only dataset
dϵ = timeline(t_end = 10)
# calculates strain data by applying a function of time
dϵ = strainfunction(dϵ, t -&gt; sin(t))

# Plot strain data
p = plot(dϵ.t, dϵ.ϵ,
    linestyle = :dash,
    color = :blue,
    label = &quot;Input strain&quot;,
    xlabel = &quot;Time&quot;,
    ylabel = &quot;Stress&quot;,
    legend = :topright
)

# we can now simulate various models based on this strain only dataset
# Let&#39;s study the role of the dashpot strength in the MAxwell model
for η in [0.1, 0.3, 1, 3, 10]
    maxwell_model = RheoModel(Maxwell, k = 2.0, η = η)
    d_maxwell = modelpredict(dϵ, maxwell_model)
    plot!(p, d_maxwell.t, d_maxwell.σ, label = &quot;η = $η&quot;)
end
plot!(p, grid = true)</code></pre><img src="182b1cf5.svg" alt="Example block output"/><h2 id="Example-4"><a class="docs-heading-anchor" href="#Example-4">Example 4</a><a id="Example-4-1"></a><a class="docs-heading-anchor-permalink" href="#Example-4" title="Permalink"></a></h2><p>This example demonstrates generating a timeline and stress data, fitting multiple models to the data, calling the <code>extractfitdata</code> function, listing the errors, and determining which model fits the best.</p><p>Generate Timeline</p><pre><code class="language-julia hljs">datat = timeline(t_start = 0, t_end = 20.0, step = 0.02)  # Create a timeline from 0 to 20 seconds with a step size of 0.02 seconds</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"></code></pre><p>Generate Stress Data (Ramp &amp; hold)</p><pre><code class="language-julia hljs">dramp_stress = stressfunction(datat, ramp(offset = 4.0, gradient = 0.8))  # Generate a ramp stress function with offset 4.0 and gradient 0.8
dhold_stress = dramp_stress - stressfunction(datat, ramp(offset = 5.0, gradient = 0.8))  # Generate a hold stress function by subtracting a shifted ramp</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"></code></pre><p>Define the rheological model and predict</p><pre><code class="language-julia hljs">model = RheoModel(SLS_Zener, (η = 1, kᵦ = 1, kᵧ = 1))
data = modelpredict(dhold_stress, model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"></code></pre><p>Fit three models to the data</p><pre><code class="language-julia hljs">SLS_Zener_model = modelfit(data, SLS_Zener, stress_imposed)
Maxwell_model = modelfit(data, Maxwell, stress_imposed)
BurgersLiquid_model = modelfit(data, BurgersLiquid, stress_imposed)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
Model name: burgerliquid

Free parameters: 


Fixed parameters: (η₁ = 2.2791392395938356e16, k₁ = 1.9214746727288188e16, η₂ = 0.765625, k₂ = 1.03125)


                                                         ___
                                                 _________| |________
                 ___                            |        _|_| η₂     |
             _____| |________╱╲  ╱╲  ╱╲  _______|                    |____
                 _|_|          ╲╱  ╲╱  ╲╱       |                    |
                    η₁                  k₁      |____╱╲  ╱╲  ╱╲  ____|
                                                       ╲╱  ╲╱  ╲╱
                                                                 k₂

                </code></pre><p>Call the extractfitdata function to extract fitting data</p><pre><code class="language-julia hljs">extracted_data = extractfitdata(data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{String, Vector{@NamedTuple{params, info, index::Int64}}} with 3 entries:
  &quot;SLS_Zener&quot;    =&gt; [@NamedTuple{params, info, index::Int64}(((η = 1.00165, kᵦ …
  &quot;burgerliquid&quot; =&gt; [@NamedTuple{params, info, index::Int64}(((η₁ = 2.27914e16,…
  &quot;maxwell&quot;      =&gt; [@NamedTuple{params, info, index::Int64}(((η = 57.064, k = …</code></pre><p>Determine which model fits best by comparing errors</p><pre><code class="language-julia hljs">function find_best_model(extracted_data)
    best_model = &quot;&quot;
    min_error = Inf

    for (model_name, fitdata) in extracted_data
        err = fitdata[1].info.error
        println(&quot;Model: $model_name, Total Error: $err&quot;)

        if err &lt; min_error
            min_error = err
            best_model = model_name
        end
    end

    println(&quot;Best fitting model: $best_model with total error: $min_error&quot;)
    return best_model, min_error
end

best_model, min_error = find_best_model(extracted_data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(&quot;SLS_Zener&quot;, 7.037654035719165e-6)</code></pre><p>Create strain-only data for model predictions</p><pre><code class="language-julia hljs">stress_only_data = onlystress(data)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"></code></pre><p>Get model predictions for plotting</p><pre><code class="language-julia hljs">SLS_Zener_predict = modelpredict(stress_only_data, SLS_Zener_model)
Maxwell_predict = modelpredict(stress_only_data, Maxwell_model)
BurgersLiquid_predict = modelpredict(stress_only_data, BurgersLiquid_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"></code></pre><p>Plot data and fitted models</p><pre><code class="language-julia hljs">p = plot(data.t, data.ϵ,
    seriestype = :scatter,
    color = :green,
    label = &quot;Original Data&quot;,
    xlabel = &quot;Time&quot;,
    ylabel = &quot;Strain&quot;,
    legend = :topright,
    grid = true
)</code></pre><img src="613e912f.svg" alt="Example block output"/><p>Overlay fitted models</p><pre><code class="language-julia hljs">plot!(p, SLS_Zener_predict.t, SLS_Zener_predict.ϵ, color = :red, linestyle = :solid, label = &quot;SLS_Zener Model&quot;)
plot!(p, Maxwell_predict.t, Maxwell_predict.ϵ, color = :blue, linestyle = :dash, label = &quot;Maxwell Model&quot;)
plot!(p, BurgersLiquid_predict.t, BurgersLiquid_predict.ϵ, color = :purple, linestyle = :dot, label = &quot;BurgersLiquid Model&quot;)</code></pre><img src="04b15b8f.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../model_create/">« Create Your Model</a><a class="docs-footer-nextpage" href="../API/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 16 February 2026 15:58">Monday 16 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
